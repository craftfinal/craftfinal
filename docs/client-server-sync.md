# Client server synchronization

The synchronization between client (browser) and server occurs based on items and their descendats.

## Main case: both client and server item have descendants

Both client and server already have some descendants and we now need to preserve
the user's intent.

We assume that the server state has been created by the same user, hence
has the same or higher chance of being the user's intent.

Matching of descendants created on this client is based on their `clientId`,
which is generated on the client and returned to the client that sent the descendant,
but the clientId is never stored on the server.
The client stops sending the clientId to the server after having received an
updated descendant that matches the clientId. based on this matching, the client then
assigns the id generated by the server.

Hence, for every descendant from the server, the client determines if it has a clientId.
WITH CLIENTID:
If the server's descendant has a clientId, the client tries to match it based on
this identifier.
In case it cannot find a matching descendant, it creates a new one matching the server's id

WITHOUT CLIENTID:
If the server's descendant does not have a clientId, then it either already exists
on the client or it has been created on a different client.
If it exists, the version with the more recent `lastModified` timestamp wins. If it
is from the server, we set the disposition to `Synced`
If no match is found based on the server's id, the server's descendant is augmented
with a new `clientId` and
then added to the client store, also marked as `Synced`

If an descendant from the server exists also on the client based on its `id`, then
the descendant with the more recent `lastModified` timestamp wins. If it is from the
server, we set the disposition to `Synced`
Otherwise, the server's descendant is augmented with a new `clientId` and
then added to the client store, also marked as `Synced`

Soft deletion
A valid `Date` in `deletetAt` property indicates the user's intent to delete
the descendant. However, we only consider this intent if the following
prerequisites are met:
